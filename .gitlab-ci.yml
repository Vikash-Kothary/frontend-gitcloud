---
image: node:14.15.4

variables:
  ENV: ci
  CI: "true"
  YARN: yarn
  NODE_ENV: ci

cache:
  key: ${CI_COMMIT_REF_SLUG}
  paths:
    - node_modules
    - build

stages:
  - clean
  - lint
  - tests
  - build
  - release
  - package
  - deploy

before_script:
  - make help-frontend
  - echo
  - make init-frontend

# lint:
#   stage: lint
#   script:
#     - make lint-frontend

tests:
  stage: tests
  script:
    - make tests-frontend

build:
  stage: build
  script:
    - make build-frontend

release:
  stage: release
  script:
    - make release-frontend

# GitLab Pages requires the job name to be pages.
pages:
  stage: deploy
  script:
      # GitLab pages requires the artifact to be called public.
      - mv build/docs public
  artifacts:
    paths:
      - public
  only:
    - develop